# HandShakes

## Что умеет бот?
Каждый, кто зарегистрирован в соцсетях, знает, что пользователи могут добавлять друг друга в друзья. Так как дружеские связи можно представить в виде графа, их удобно исследовать.
В данный момент бот работает с ВК и умеет отвечать на 2 вида запросов:
1) get_common_friends - найти общих друзей у нескольких пользователей;
2) get_friends_chain - найти цепочку друзей (рукопожатий) для 2 пользователей.

## Запуск приложения

`git clone https://github.com/EkaterinaAlimaskina/HandShakesBot.git`  
`cd HandShakesBot`  
`docker build --env VK_TOKEN=<ваш токен VK API> --env TG_TOKEN=<токен вашего телеграм бота> hs_bot .`  
`docker run -d hs_bot`

## Использование приложения
Осталось запустить вашего бота в телеграм. Моего бота зовут так: `@HandShakesBot`. 

Введите одну из команд по образцу, подождите несколько секунд и наслаждайтесь результатом :)

## Архитектура приложения - для интересующихся ;)

I. Глобально использован паттерн MVC, который разделил приложение на 3 части:
1) Model - вся логика получения и обработки графов друзей;
2) View - часть, отвечающая за то, что видит пользователь;
3) Controller/TelegramController - связывает Model и View и знает о сценарии работы.

Это было сделано, потому что эти части интуитивно довольно независимы и, значит, их хочется разрабатывать и тестировать отдельно. 

II. Для работы приложению требуются настройки, которые лежат в config.yml. Чтобы не читать их во всех классах, есть специальных класс Config, который создается в единственном экземпляре (Singleton) и читает config.yml при создании. 
В классе Config есть геттеры для всех настроек, чтобы информация о том, как устроен config.yml хранилась в одном месте, а именно в Config. Все остальные классы создают себе приватное поле config и пользуются этими геттерами. 

III. Так как на будущее хочется оставить свободу для выбора пользовательского представления, то есть абстрактный класс View, который и является интерфейсом, доступным Контроллеру. От него могут наследоваться разные виды представлений, например, сейчас это ConsoleView и TelegramView. 
Чтобы создать наследника определнного типа, используется фабричный метод.

IV. Главная часть Модели - это класс SocialNetwork. В нем реализуется логика поиска ответа на запрос пользователя, например, обход графа, поиск пересечения друзей и так далее. Для этого нужно пользоваться api конкретной социальной сети. По сути SocialNetwork - Фасад, скрывающий запросы к api.

V. Чтобы не реализовавать в методы SocialNetwork отдельно для каждой соцсети, создан абстрактный класс SocialNetworkApi, являющийся интрейфесом api для SocialNetwork. От него могут наследоваться классы api для всех соцсетей, например VKApi. Чтобы создать наследника определенного типа, используется фабричный метод.
Когда пользователь выбирает соцсеть, приватное поле api в SocialNetwork устанавливается с помощью сеттера.

VI. Controller/TelegramController осуществляет общее руководство процессом, храня в себе View и SocialNetwork. 


